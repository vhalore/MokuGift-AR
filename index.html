<!DOCTYPE html>
<html>
<head>
  <title>MokuGift AR (Huawei Compatible)</title>
  <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
  <style>
    .arjs-loader {
      height: 100%;
      width: 100%;
      position: absolute;
      top: 0;
      left: 0;
      background-color: rgba(0, 0, 0, 0.8);
      z-index: 9999;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      color: white;
    }
  </style>
</head>
<body>
  <!-- Loading Screen -->
  <div class="arjs-loader">
    <div>Loading AR...</div>
    <div id="huawei-hint" style="display: none; margin-top: 20px;">
      <p>On Huawei, try:</p>
      <ol>
        <li>Download this <a href="assets/hiro.png" download>AR marker</a></li>
        <li>Print it or display on another device</li>
        <li>Point your camera at it</li>
      </ol>
    </div>
  </div>

  <!-- AR Scene -->
  <a-scene 
    vr-mode-ui="enabled: false"
    renderer="logarithmicDepthBuffer: true;"
    embedded arjs="trackingMethod: best; sourceType: webcam;"
  >
    <a-nft
      type="nft"
      url="assets/hiro"
      smooth="true"
      smoothCount="10"
      smoothTolerance="0.01"
      smoothThreshold="5"
    >
      <a-entity gltf-model="models/3d.glb" scale="0.1 0.1 0.1"></a-entity>
    </a-nft>
    <a-entity camera></a-entity>
  </a-scene>

  <script>
    // Huawei-specific detection
    const isHuawei = /huawei/i.test(navigator.userAgent);
    const loader = document.querySelector('.arjs-loader');
    
    if (isHuawei) {
      document.getElementById('huawei-hint').style.display = 'block';
    }

    // Hide loader when AR loads
    document.querySelector('a-scene').addEventListener('loaded', () => {
      setTimeout(() => {
        loader.style.display = 'none';
      }, 1500);
    });
  </script>
</body>
</html>
